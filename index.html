<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ูุธุงู ุฅุฏุงุฑุฉ ุงูููุงุฆู ูุงูููุฑุฏูู</title>
  <link rel="stylesheet" href="styles.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800&display=swap" rel="stylesheet">
</head>
<body>
  <div class="app">
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
      <div class="sidebar-header">
        <h1 class="logo">ููุงุฆู</h1>
        <button class="sidebar-close" id="sidebarClose" aria-label="ุฅุบูุงู ุงููุงุฆูุฉ">ร</button>
      </div>
      <nav class="sidebar-nav">
        <a href="#dashboard" class="nav-item active" data-page="dashboard">
          <span class="nav-icon">๐</span>
          <span>ููุญุฉ ุงูุชุญูู</span>
        </a>
        <a href="#suppliers" class="nav-item" data-page="suppliers">
          <span class="nav-icon">๐ข</span>
          <span>ุงูููุฑุฏูู</span>
        </a>
        <a href="#add-supplier" class="nav-item" data-page="add-supplier">
          <span class="nav-icon">โ</span>
          <span>ุฅุถุงูุฉ ููุฑุฏ</span>
        </a>
        <a href="#add-list" class="nav-item" data-page="add-list">
          <span class="nav-icon">๐</span>
          <span>ุฅุถุงูุฉ ูุงุฆูุฉ ุดุฑุงุก</span>
        </a>
        <a href="#lists" class="nav-item" data-page="lists">
          <span class="nav-icon">๐</span>
          <span>ุนุฑุถ ุงูููุงุฆู</span>
        </a>
        <a href="#transactions" class="nav-item" data-page="transactions">
          <span class="nav-icon">๐</span>
          <span>ุงูุญุฑูุงุช ูุงููุดุงุท</span>
        </a>
      </nav>
    </aside>

    <!-- Mobile overlay -->
    <div class="sidebar-overlay" id="sidebarOverlay"></div>

    <!-- Main content -->
    <main class="main">
      <header class="header">
        <button class="menu-btn" id="menuBtn" aria-label="ูุชุญ ุงููุงุฆูุฉ">โฐ</button>
        <h2 class="page-title" id="pageTitle">ููุญุฉ ุงูุชุญูู</h2>
      </header>

      <div class="content">
        <!-- Dashboard -->
        <section id="dashboard" class="page active">
          <div class="stats-grid">
            <div class="stat-card">
              <span class="stat-value" id="statSuppliers">0</span>
              <span class="stat-label">ุงูููุฑุฏูู</span>
            </div>
            <div class="stat-card">
              <span class="stat-value" id="statLists">0</span>
              <span class="stat-label">ุงูููุงุฆู</span>
            </div>
            <div class="stat-card">
              <span class="stat-value" id="statTotalAmount">0</span>
              <span class="stat-label">ุฅุฌูุงูู ุงููุจุงูุบ (ุตุงูู: ุงูุฅุฌูุงูู โ ุงููุฏููุน)</span>
            </div>
            <div class="stat-card">
              <span class="stat-value" id="statPaid">0</span>
              <span class="stat-label">ุงููุฏููุน</span>
            </div>
            <div class="stat-card stat-usd">
              <span class="stat-value" id="statTotalUSD">0</span>
              <span class="stat-label">ุฅุฌูุงูู (ุฏููุงุฑ) ุตุงูู: ุงูุฅุฌูุงูู โ ุงููุฏููุน</span>
            </div>
            <div class="stat-card stat-usd">
              <span class="stat-value" id="statPaidUSD">0</span>
              <span class="stat-label">ุงููุฏููุน (ุฏููุงุฑ)</span>
            </div>
          </div>
          <div class="card">
            <h3>ุขุฎุฑ ุงูููุงุฆู</h3>
            <div class="recent-lists" id="recentLists">
              <p class="empty-msg">ูุง ุชูุฌุฏ ููุงุฆู ุญุฏูุซุฉ</p>
            </div>
          </div>
        </section>

        <!-- Suppliers list -->
        <section id="suppliers" class="page">
          <div class="card">
            <h3>ูุงุฆูุฉ ุงูููุฑุฏูู</h3>
            <div class="search-wrap">
              <input type="search" id="suppliersSearch" class="search-input" placeholder="ุจุญุซ (ุงูุงุณูุ ุงููุงุชูุ ุงูุนููุงู)" aria-label="ุจุญุซ ูู ุงูููุฑุฏูู">
            </div>
            <div class="table-wrap">
              <table class="table">
                <thead>
                  <tr>
                    <th>ุงูุงุณู</th>
                    <th>ุฑูู ุงููุงุชู</th>
                    <th>ุงูุนููุงู</th>
                    <th>ุงูุฑุตูุฏ ุงูุงูุชุชุงุญู</th>
                    <th>ุฅุฌูุงูู ุงูููุงุฆู</th>
                    <th>ุงููุฏููุน</th>
                    <th>ุงููุชุจูู</th>
                    <th>ุงูุฅุฌุฑุงุกุงุช</th>
                  </tr>
                </thead>
                <tbody id="suppliersTableBody">
                  <tr><td colspan="8" class="empty-cell">ูุง ููุฌุฏ ููุฑุฏูู</td></tr>
                </tbody>
              </table>
            </div>
          </div>
        </section>

        <!-- Add Supplier -->
        <section id="add-supplier" class="page">
          <div class="card form-card">
            <h3>ุฅุถุงูุฉ ููุฑุฏ ุฌุฏูุฏ</h3>
            <form id="addSupplierForm" class="form">
              <div class="form-group">
                <label for="supplierName">ุงูุงุณู</label>
                <input type="text" id="supplierName" required placeholder="ุงุณู ุงูููุฑุฏ">
              </div>
              <div class="form-group">
                <label for="supplierPhone">ุฑูู ุงููุงุชู (11 ุฑูููุง ูุญุฏ ุฃูุตู)</label>
                <input type="tel" id="supplierPhone" required placeholder="07xxxxxxxxx" maxlength="11" inputmode="numeric" pattern="[0-9]*">
              </div>
              <div class="form-group">
                <label for="supplierAddress">ุงูุนููุงู</label>
                <input type="text" id="supplierAddress" required placeholder="ุงูุนููุงู ุงููุงูู">
              </div>
              <div class="form-group">
                <label for="supplierOpeningBalance">ุฑุตูุฏ ุงูุชุชุงุญู (ุงุฎุชูุงุฑู)</label>
                <div class="inline-fields">
                  <input type="number" id="supplierOpeningBalance" min="0" step="0.01" value="0" placeholder="0">
                  <select id="supplierOpeningBalanceCurrency">
                    <option value="IQD">ุฏ.ุน</option>
                    <option value="USD">ุฏููุงุฑ</option>
                  </select>
                </div>
              </div>
              <button type="submit" class="btn btn-primary">ุญูุธ ุงูููุฑุฏ</button>
            </form>
          </div>
        </section>

        <!-- Add Purchase List -->
        <section id="add-list" class="page">
          <div class="card form-card">
            <h3>ุฅุถุงูุฉ ูุงุฆูุฉ ุดุฑุงุก</h3>
            <form id="addListForm" class="form">
              <div class="form-group">
                <label for="listSupplier">ุงุฎุชูุงุฑ ุงูููุฑุฏ</label>
                <select id="listSupplier" required>
                  <option value="">-- ุงุฎุชุฑ ุงูููุฑุฏ --</option>
                </select>
              </div>
              <div class="form-group">
                <label for="listNumber">ุฑูู ุงููุงุฆูุฉ</label>
                <input type="text" id="listNumber" required placeholder="ูุซุงู: L-001">
              </div>
              <div class="form-group">
                <label for="listCurrency">ุงูุนููุฉ</label>
                <select id="listCurrency">
                  <option value="IQD">ุฏ.ุน โ ุฏููุงุฑ ุนุฑุงูู</option>
                  <option value="USD">ุฏููุงุฑ ุฃูุฑููู</option>
                </select>
              </div>
              <div class="form-group">
                <label>ููุน ุงูููุชุฌ</label>
                <div class="product-row product-row-header">
                  <span class="product-col-type">ููุน ุงูููุชุฌ</span>
                  <span class="product-col-qty">ุงููููุฉ</span>
                  <span class="product-col-price">ุณุนุฑ ุงูููุฑุฏ</span>
                  <span class="product-col-total">ุงููุฌููุน</span>
                  <span class="product-col-action"></span>
                </div>
                <div id="productFieldsContainer">
                  <div class="product-row" data-index="0">
                    <input type="text" class="product-type product-col-type" placeholder="ููุน ุงูููุชุฌ">
                    <input type="number" class="product-quantity product-col-qty" min="0" step="1" value="1" placeholder="0">
                    <input type="number" class="product-unit-price product-col-price" min="0" step="0.01" value="0" placeholder="0.00">
                    <span class="product-total product-col-total">0.00</span>
                    <button type="button" class="btn-icon remove-product product-col-action" title="ุญุฐู">โ</button>
                  </div>
                </div>
                <button type="button" class="btn btn-outline add-product-btn" id="addProductRow">+ ุฅุถุงูุฉ ููุน ููุชุฌ</button>
              </div>
              <div class="form-group">
                <label for="listAmount" id="listAmountLabel">ูุจูุบ ุงููุงุฆูุฉ โ ูุฌูุน ูู ุงูููุชุฌุงุช</label>
                <input type="text" id="listAmount" readonly class="list-amount-readonly" value="0.00" dir="ltr">
              </div>
              <div class="form-group">
                <label for="listImage">ุฅุฑูุงู ุตูุฑุฉ ูููุงุฆูุฉ</label>
                <div class="image-options">
                  <input type="file" id="listImage" accept="image/*" class="file-input">
                  <button type="button" class="btn btn-outline" id="captureImageBtn">๐ท ุงูุชูุงุท ุตูุฑุฉ</button>
                </div>
                <div class="image-preview" id="listImagePreview"></div>
              </div>
              <button type="submit" class="btn btn-primary">ุญูุธ ุงููุงุฆูุฉ</button>
            </form>
          </div>
        </section>

        <!-- Lists table -->
        <section id="lists" class="page">
          <div class="card">
            <h3>ุนุฑุถ ุงูููุงุฆู</h3>
            <div class="search-wrap">
              <input type="search" id="listsSearch" class="search-input" placeholder="ุจุญุซ (ุงูููุฑุฏุ ุฑูู ุงููุงุฆูุฉุ ุงููุจูุบ)" aria-label="ุจุญุซ ูู ุงูููุงุฆู">
            </div>
            <div class="table-wrap table-responsive">
              <table class="table">
                <thead>
                  <tr>
                    <th>ุงูููุฑุฏ</th>
                    <th>ุฑูู ุงููุงุฆูุฉ</th>
                    <th>ุงูุชุงุฑูุฎ</th>
                    <th>ุงููุจูุบ</th>
                    <th>ุงููุฏููุน</th>
                    <th>ุงูุฅุฌุฑุงุกุงุช</th>
                  </tr>
                </thead>
                <tbody id="listsTableBody">
                  <tr><td colspan="6" class="empty-cell">ูุง ุชูุฌุฏ ููุงุฆู</td></tr>
                </tbody>
              </table>
            </div>
          </div>
        </section>

        <!-- Transactions / Activity -->
        <section id="transactions" class="page">
          <div class="card">
            <h3>ุงูุญุฑูุงุช ูุงููุดุงุท</h3>
            <div class="search-wrap">
              <input type="search" id="activitySearch" class="search-input" placeholder="ุจุญุซ ูู ุงูุญุฑูุงุช" aria-label="ุจุญุซ ูู ุงูุญุฑูุงุช">
            </div>
            <div class="activity-list" id="activityList">
              <p class="empty-msg">ูุง ุชูุฌุฏ ุญุฑูุงุช</p>
            </div>
          </div>
        </section>
      </div>

      <!-- Bottom nav (mobile) -->
      <nav class="bottom-nav" id="bottomNav">
        <a href="#dashboard" class="bottom-nav-item" data-page="dashboard">๐</a>
        <a href="#add-supplier" class="bottom-nav-item" data-page="add-supplier">โ</a>
        <a href="#add-list" class="bottom-nav-item" data-page="add-list">๐</a>
        <a href="#lists" class="bottom-nav-item" data-page="lists">๐</a>
        <a href="#transactions" class="bottom-nav-item" data-page="transactions">๐</a>
      </nav>
    </main>
  </div>

  <!-- Modal: Partial payment -->
  <div class="modal" id="paymentModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>ุฏูุน ุฌุฒุฆู</h3>
        <button class="modal-close" id="paymentModalClose">ร</button>
      </div>
      <form id="paymentForm">
        <input type="hidden" id="paymentListId">
        <div class="form-group">
          <label for="paymentAmount">ุงููุจูุบ</label>
          <input type="number" id="paymentAmount" min="0" step="0.01" required>
        </div>
        <button type="submit" class="btn btn-primary">ุชุณุฌูู ุงูุฏูุน</button>
      </form>
    </div>
  </div>

  <!-- Modal: ุงูุชูุงุท ุตูุฑุฉ -->
  <div class="modal" id="captureImageModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>ุงูุชูุงุท ุตูุฑุฉ</h3>
        <button class="modal-close" id="captureImageModalClose" type="button">ร</button>
      </div>
      <div class="capture-body">
        <video id="captureVideo" autoplay playsinline muted></video>
        <div class="capture-actions">
          <button type="button" class="btn btn-primary" id="captureTakeBtn">ุงูุชูุท</button>
          <button type="button" class="btn btn-outline" id="captureCancelBtn">ุฅูุบุงุก</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal: ุฏูุน ุฌุฒุฆู ููููุฑุฏ -->
  <div class="modal" id="supplierPaymentModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>ุฏูุน ุฌุฒุฆู ููููุฑุฏ</h3>
        <button class="modal-close" id="supplierPaymentModalClose">ร</button>
      </div>
      <form id="supplierPaymentForm">
        <input type="hidden" id="supplierPaymentId">
        <p class="modal-supplier-name" id="supplierPaymentName"></p>
        <div class="form-group">
          <label for="supplierPaymentCurrency">ุงูุนููุฉ</label>
          <select id="supplierPaymentCurrency">
            <option value="IQD">ุฏ.ุน</option>
            <option value="USD">ุฏููุงุฑ</option>
          </select>
        </div>
        <div class="form-group">
          <label for="supplierPaymentAmount">ุงููุจูุบ</label>
          <input type="number" id="supplierPaymentAmount" min="0" step="0.01" required placeholder="0.00">
        </div>
        <button type="submit" class="btn btn-primary">ุชุณุฌูู ุงูุฏูุน</button>
      </form>
    </div>
  </div>

  <!-- Modal: List details (image + products) -->
  <div class="modal" id="listDetailModal">
    <div class="modal-content modal-lg">
      <div class="modal-header">
        <h3>ุชูุงุตูู ุงููุงุฆูุฉ</h3>
        <div class="modal-header-actions">
          <button type="button" class="btn btn-sm btn-primary" id="listDetailPrintBtn" title="ุทุจุงุนุฉ">๐จ๏ธ ุทุจุงุนุฉ</button>
          <button class="modal-close" id="listDetailModalClose">ร</button>
        </div>
      </div>
      <div id="listDetailContent"></div>
    </div>
  </div>

  <!-- Modal: ุชูุงุตูู ุงูููุฑุฏ (ุงูููุงุฆู ูุงูุฏูุนุงุช) -->
  <div class="modal" id="supplierDetailModal">
    <div class="modal-content modal-lg">
      <div class="modal-header">
        <h3>ุชูุงุตูู ุงูููุฑุฏ</h3>
        <div class="modal-header-actions">
          <button type="button" class="btn btn-sm btn-primary" id="supplierDetailPrintBtn" title="ุทุจุงุนุฉ">๐จ๏ธ ุทุจุงุนุฉ</button>
          <button class="modal-close" id="supplierDetailModalClose">ร</button>
        </div>
      </div>
      <div id="supplierDetailContent"></div>
    </div>
  </div>

  <!-- ููุทูุฉ ุงูุทุจุงุนุฉ (ูุฎููุฉุ ุชุธูุฑ ุนูุฏ ุงูุทุจุงุนุฉ ููุท) -->
  <div id="printArea" class="print-area"></div>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-database-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-storage-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-analytics-compat.js"></script>
  <script src="firebase-config.js"></script>
  <script src="script.js"></script>
</body>
</html>
